{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../src/components/auth/MFAEnrollment.tsx"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { createClient } from \"@/utils/supabase/client\";\r\nimport QRCode from \"qrcode\";\r\n\r\nexport default function MFAEnrollment({ onEnrolled }: { onEnrolled?: () => void }) {\r\n  const [factorId, setFactorId] = useState<string | null>(null);\r\n  const [qrCodeData, setQrCodeData] = useState<string | null>(null);\r\n  const [secret, setSecret] = useState<string | null>(null);\r\n  const [code, setCode] = useState(\"\");\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    async function setupMFA() {\r\n      const supabase = createClient();\r\n      const { data, error } = await supabase.auth.mfa.enroll({\r\n        factorType: \"totp\",\r\n      });\r\n\r\n      if (error) {\r\n        setError(error.message);\r\n        return;\r\n      }\r\n\r\n      setFactorId(data.id);\r\n      setSecret(data.totp.secret);\r\n      setQrCodeData(data.totp.qr_code);\r\n    }\r\n\r\n    setupMFA();\r\n  }, []);\r\n\r\n  const onVerify = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!factorId) return;\r\n\r\n    setLoading(true);\r\n    const supabase = createClient();\r\n    const { data, error } = await supabase.auth.mfa.challengeAndVerify({\r\n      factorId,\r\n      code,\r\n    });\r\n\r\n    setLoading(false);\r\n\r\n    if (error) {\r\n      setError(error.message);\r\n    } else {\r\n      if (onEnrolled) onEnrolled();\r\n    }\r\n  };\r\n\r\n  if (!qrCodeData) {\r\n    return <div>Loading MFA setup...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4 max-w-sm mx-auto p-4 border rounded bg-white\">\r\n      <h3 className=\"text-lg font-bold\">Enable Two-Factor Authentication</h3>\r\n      <p className=\"text-sm text-gray-600\">\r\n        Scan the QR code below with your authenticator app (Google Authenticator, Authy, etc.).\r\n      </p>\r\n\r\n      <div className=\"flex justify-center my-4\">\r\n        {/* We can use the svg directly from TOTP API usually, but if it returns a uri, render image */}\r\n         <img src={qrCodeData} alt=\"QR Code\" className=\"w-48 h-48\" />\r\n      </div>\r\n      \r\n      {/* Fallback secret display is good practice */}\r\n      <div className=\"bg-gray-50 p-2 rounded text-xs break-all font-mono text-center\">\r\n         {secret}\r\n      </div>\r\n\r\n      <form onSubmit={onVerify} className=\"space-y-2\">\r\n        <label className=\"block text-sm font-medium text-gray-700\">Enter Code</label>\r\n        <input\r\n          type=\"text\"\r\n          value={code}\r\n          onChange={(e) => setCode(e.target.value)}\r\n          placeholder=\"123456\"\r\n          className=\"w-full rounded border-gray-300 p-2 border\"\r\n        />\r\n        {error && <p className=\"text-red-500 text-sm\">{error}</p>}\r\n        <button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className=\"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700 disabled:opacity-50\"\r\n        >\r\n            {loading ? \"Verifying...\" : \"Enable MFA\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React"],"mappings":"0NA0BQG,EAAOC,OAAO,CAAGC,EAAQ,CAAA,CAAA,IAAA,iCC1BjCF,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRI,QAAQ,CAAC,YAAY,CAAEC,eAAe,+BCFxCP,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRI,QAAQ,CAAC,YAAY,CAAEE,KAAK,0CCA9B,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAGe,SAAS,EAAc,YAAE,CAAU,CAA+B,EAC/E,GAAM,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAClD,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MACtD,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC9C,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC3B,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAEvC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,MACR,AAgBA,eAhBe,EACb,IAAM,EAAW,CAAA,EAAA,EAAA,YAAA,AAAY,IACvB,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CACrD,WAAY,MACd,EAEA,CAAI,EACF,EAAS,EAAM,CADN,MACa,GAIxB,EAAY,EAAK,EAAE,EACnB,EAAU,EAAK,IAAI,CAAC,MAAM,EAC1B,EAAc,EAAK,IAAI,CAAC,OAAO,EACjC,GAGF,EAAG,EAAE,EAEL,IAAM,EAAW,MAAO,IAEtB,GADA,EAAE,cAAc,GACZ,CAAC,EAAU,OAEf,GAAW,GACX,IAAM,EAAW,CAAA,EAAA,EAAA,YAAA,AAAY,IACvB,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,UACjE,OACA,CACF,GAEA,GAAW,GAEP,EACF,EAAS,EAAM,CADN,MACa,EAElB,GAAY,GAEpB,SAEA,AAAK,EAKH,CAAA,CALE,CAKF,EAAA,IAAA,CALe,CAKd,MAAA,CAAI,UAAU,mEACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,6BAAoB,qCAClC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAwB,4FAIrC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oCAEZ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAK,EAAY,IAAI,UAAU,UAAU,gBAIjD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0EACX,IAGJ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,EAAU,UAAU,sBAClC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,mDAA0C,eAC3D,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,EACvC,YAAY,SACZ,UAAU,8CAEX,GAAS,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,gCAAwB,IAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,KAAK,SACL,SAAU,EACV,UAAU,2FAET,EAAU,eAAiB,qBAnC7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,wBAwChB","ignoreList":[0,1,2]}