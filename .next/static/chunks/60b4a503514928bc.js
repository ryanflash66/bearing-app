(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52622,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(90615);function s({onEnrolled:e}){let[s,n]=(0,a.useState)(null),[r,c]=(0,a.useState)(null),[i,o]=(0,a.useState)(null),[u,d]=(0,a.useState)(""),[m,h]=(0,a.useState)(null),[x,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{!async function(){let e=(0,l.createClient)(),{data:t,error:a}=await e.auth.mfa.enroll({factorType:"totp"});a?h(a.message):(n(t.id),o(t.totp.secret),c(t.totp.qr_code))}()},[]);let p=async t=>{if(t.preventDefault(),!s)return;b(!0);let a=(0,l.createClient)(),{data:n,error:r}=await a.auth.mfa.challengeAndVerify({factorId:s,code:u});b(!1),r?h(r.message):e&&e()};return r?(0,t.jsxs)("div",{className:"space-y-4 max-w-sm mx-auto p-4 border rounded bg-white",children:[(0,t.jsx)("h3",{className:"text-lg font-bold",children:"Enable Two-Factor Authentication"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Scan the QR code below with your authenticator app (Google Authenticator, Authy, etc.)."}),(0,t.jsx)("div",{className:"flex justify-center my-4",children:(0,t.jsx)("img",{src:r,alt:"QR Code",className:"w-48 h-48"})}),(0,t.jsx)("div",{className:"bg-gray-50 p-2 rounded text-xs break-all font-mono text-center",children:i}),(0,t.jsxs)("form",{onSubmit:p,className:"space-y-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Enter Code"}),(0,t.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),placeholder:"123456",className:"w-full rounded border-gray-300 p-2 border"}),m&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:m}),(0,t.jsx)("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700 disabled:opacity-50",children:x?"Verifying...":"Enable MFA"})]})]}):(0,t.jsx)("div",{children:"Loading MFA setup..."})}e.s(["default",()=>s])}]);